name = "iris"
main = "worker/worker.ts"
compatibility_date = "2024-12-30"
assets = { not_found_handling = "single-page-application" }
preview_urls = true

[ai]
binding = "AI"

[observability]
enabled = true

[[routes]]
pattern = "iris.yinflow.life"
custom_domain = true

# Set up the durable objects
[durable_objects]
bindings = [
    { name = "AGENT_DURABLE_OBJECT", class_name = "AgentDurableObject" },
    { name = "VOICE_AGENT_DO", class_name = "VoiceAgentDurableObject" },
]

# Durable objects require migrations to create/modify/delete them
[[migrations]]
tag = "v1"
new_classes = ["TldrawAiDurableObject"]

[[migrations]]
tag = "v2"
renamed_classes = [
    { from = "TldrawAiDurableObject", to = "AgentDurableObject" },
]

[[migrations]]
tag = "v3"
new_classes = ["VoiceAgentDurableObject"]

[vars]
TTS_ENABLED = "false"
